{% extends 'Base/base.html' %}
{% block title %}Registro{% endblock %}

{% block content %}
<div class="card auth-card">
  <h2>Crear cuenta</h2>

  <form method="post" action="{{ url_for('register') }}">
    <!-- Datos comunes -->
    <label for="username">Usuario</label>
    <input id="username" name="username" type="text" required>

    <label for="email">Correo electr칩nico</label>
    <input id="email" name="email" type="email" required>

    <label for="password">Contrase침a</label>
    <input id="password" name="password" type="password" required>

    <!-- Selecci칩n de rol -->
    <div class="form-group">
      <label for="role">Selecciona tu rol:</label>
      <select id="role" name="role" required onchange="mostrarCampos()">
        <option value="">-- Selecciona --</option>
        <option value="Explorador">Explorador</option>
        <option value="Emprendedor">Emprendedor</option>
      </select>
    </div>

    <!-- Descripci칩n din치mica del rol -->
    <div id="descripcion-rol" class="muted" style="margin-bottom: 1em; font-size: 0.9em; color: #555;">
      <!-- Aqu칤 se mostrar치 el texto correspondiente -->
    </div>

    <!-- Campos para Explorador -->
    <div id="explorador-fields" style="display:none;">
      <h3>Datos personales (Explorador)</h3>

      <label for="primer_nombre">Primer nombre</label>
      <input id="primer_nombre" name="primer_nombre" type="text">

      <label for="segundo_nombre">Segundo nombre</label>
      <input id="segundo_nombre" name="segundo_nombre" type="text">

      <label for="primer_apellido">Primer apellido</label>
      <input id="primer_apellido" name="primer_apellido" type="text">

      <label for="segundo_apellido">Segundo apellido</label>
      <input id="segundo_apellido" name="segundo_apellido" type="text">

      <label for="fecha_nacimiento">Fecha de nacimiento</label>
      <input id="fecha_nacimiento" name="fecha_nacimiento" type="date">

      <label for="telefono">Tel칠fono celular</label>
      <input id="telefono" name="telefono" type="text">

      <label for="preferencias">Preferencias</label>
      <select id="preferencias" name="preferencias">
        <option value="">-- Selecciona --</option>
        <option value="Comida">Comida</option>
        <option value="Hospedaje">Hospedaje</option>
        <option value="Ocio">Ocio</option>
        <option value="Cultura">Arte y Cultura</option>
        <option value="Naturaleza">Naturaleza</option>
        <option value="Compras">Compras</option>
      </select>
    </div>

    <!-- Campos para Emprendedor -->
    <div id="emprendedor-fields" style="display:none;">
      <h3>Datos personales (Emprendedor)</h3>

      <label for="primer_nombre_emp">Primer nombre</label>
      <input id="primer_nombre_emp" name="primer_nombre_emp" type="text">

      <label for="segundo_nombre_emp">Segundo nombre</label>
      <input id="segundo_nombre_emp" name="segundo_nombre_emp" type="text">

      <label for="primer_apellido_emp">Primer apellido</label>
      <input id="primer_apellido_emp" name="primer_apellido_emp" type="text">

      <label for="segundo_apellido_emp">Segundo apellido</label>
      <input id="segundo_apellido_emp" name="segundo_apellido_emp" type="text">

      <label for="fecha_nacimiento_emp">Fecha de nacimiento</label>
      <input id="fecha_nacimiento_emp" name="fecha_nacimiento_emp" type="date">

      <label for="telefono_emp">Tel칠fono celular</label>
      <input id="telefono_emp" name="telefono_emp" type="text">

    </div>

    <button class="btn btn-primary" type="submit">Registrarse</button>
  </form>

  <p class="muted">쯏a tienes cuenta? <a href="{{ url_for('login') }}">Inicia sesi칩n</a></p>
</div>

<script>
function mostrarCampos() {
  const role = document.getElementById('role').value;
  const explorador = document.getElementById('explorador-fields');
  const emprendedor = document.getElementById('emprendedor-fields');
  const descripcion = document.getElementById('descripcion-rol');

  // Seleccionar todos los inputs dentro de cada bloque
  const inputsExplorador = explorador.querySelectorAll('input, select');
  const inputsEmprendedor = emprendedor.querySelectorAll('input, select');

  if (role === 'Explorador') {
    // Mostrar explorador y ocultar emprendedor
    explorador.style.display = 'block';
    emprendedor.style.display = 'none';
    descripcion.innerHTML = "游깵 <strong>Explorador:</strong> podr치s descubrir nuestro amplio cat치logo de emprendimientos locales, guardar tus lugares favoritos, ver recomendaciones personalizadas y explorar nuevas experiencias en Ch칤a.";

    // Desactivar 'required' en campos de emprendedor
    inputsEmprendedor.forEach(i => i.removeAttribute('required'));
    // Activar 'required' en los campos principales del explorador si quieres
    inputsExplorador.forEach(i => i.removeAttribute('required'));

  } else if (role === 'Emprendedor') {
    explorador.style.display = 'none';
    emprendedor.style.display = 'block';
    descripcion.innerHTML = "游 <strong>Emprendedor:</strong> 쯈uieres impulsar tu negocio? Reg칤strate y conoce nuestros planes para destacar tu emprendimiento, acceder a estad칤sticas de visitas y llegar a m치s personas en nuestra plataforma.";

    // Desactivar 'required' en campos de explorador
    inputsExplorador.forEach(i => i.removeAttribute('required'));
    // Activar los 'required' para los campos de emprendedor necesarios
    document.getElementById('nombre_emprendimiento').setAttribute('required', '');
    document.getElementById('nit').setAttribute('required', '');

  } else {
    explorador.style.display = 'none';
    emprendedor.style.display = 'none';
    descripcion.innerHTML = "";
    inputsExplorador.forEach(i => i.removeAttribute('required'));
    inputsEmprendedor.forEach(i => i.removeAttribute('required'));
  }
}
</script>

{% endblock %}